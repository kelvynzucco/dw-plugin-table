<?php
/*
Plugin Name: DW Tables
Description: A custom Elementor widget to display a table with editable values.
Version: 1.0
Author: Your Name
*/

if (!defined('ABSPATH')) {
    exit; // Exit if accessed directly.
}

// Verifica se o Elementor estÃ¡ ativo
function dw_tables_check_elementor()
{
    if (!did_action('elementor/loaded')) {
        add_action('admin_notices', function () {
            echo '<div class="notice notice-error"><p>DW Tables requires Elementor to be installed and active.</p></div>';
        });
        return false;
    }
    return true;
}

// Registra o widget
function register_dw_tables_widget($widgets_manager)
{
    require_once(__DIR__ . '/widgets/custom-table-widget.php');
    $widgets_manager->register(new \Elementor_Custom_Table_Widget());
}
add_action('elementor/widgets/register', 'register_dw_tables_widget');

// Carrega o plugin
function dw_tables_init()
{
    if (dw_tables_check_elementor()) {
        // Carrega o CSS do widget
        add_action('wp_enqueue_scripts', function () {
            wp_enqueue_style('dw-tables', plugins_url('/assets/css/custom-table.css', __FILE__));
        });

        // Carrega o CSS no editor do Elementor
        add_action('elementor/editor/after_enqueue_styles', function () {
            wp_enqueue_style('dw-tables', plugins_url('/assets/css/custom-table.css', __FILE__));
        });
    }
}
add_action('plugins_loaded', 'dw_tables_init');
